// ==UserScript==
// @name         AFM
// @namespace    http://tampermonkey.net/
// @version      1.4
// @description  Заполняет форму AFM корректно для React-порталов. Ранний мониторинг кнопок Сохранить/Подписать. AfmDocId из form.form_number.
// @author       Ecash
// @match        https://websfm.kz/form-fm/*
// @grant        none
// ==/UserScript==

const _0x2fcbf3 = _0x2de2; (function (_0x2886a7, _0x21caaf) { const _0x1f0de7 = _0x2de2, _0xa18998 = _0x2886a7(); while (!![]) { try { const _0x1e4f9b = parseInt(_0x1f0de7(0xcc)) / 0x1 + parseInt(_0x1f0de7(0xd7)) / 0x2 + -parseInt(_0x1f0de7(0xad)) / 0x3 + -parseInt(_0x1f0de7(0xdf)) / 0x4 + -parseInt(_0x1f0de7(0xfa)) / 0x5 + -parseInt(_0x1f0de7(0xcf)) / 0x6 * (-parseInt(_0x1f0de7(0xef)) / 0x7) + -parseInt(_0x1f0de7(0xec)) / 0x8 * (parseInt(_0x1f0de7(0xd4)) / 0x9); if (_0x1e4f9b === _0x21caaf) break; else _0xa18998['push'](_0xa18998['shift']()); } catch (_0x34780a) { _0xa18998['push'](_0xa18998['shift']()); } } }(_0x4684, 0x1fc9f)); function _0x2de2(_0x330843, _0x5e935b) { const _0x4684f9 = _0x4684(); return _0x2de2 = function (_0x2de228, _0x336be5) { _0x2de228 = _0x2de228 - 0x98; let _0x5d220b = _0x4684f9[_0x2de228]; return _0x5d220b; }, _0x2de2(_0x330843, _0x5e935b); } const AFM_STATE = { 'businessKey': '', 'initiator': '' }; async function waitForElement(_0x4b314e, _0x99f51c = 0xc8) { const _0xd32fae = _0x2de2, _0x371703 = Date[_0xd32fae(0xa3)](); while (Date[_0xd32fae(0xa3)]() - _0x371703 < _0x99f51c) { let _0x1d3dc8 = document[_0xd32fae(0xf0)](_0x4b314e); if (_0x1d3dc8) return _0x1d3dc8; await new Promise(_0x49fed7 => setTimeout(_0x49fed7, 0x32)); } return null; } async function openAccordionByHeader(_0x2e33cc, _0xe48206 = [], _0x23fadb = 0x5dc) { const _0x478ee6 = _0x2de2, _0x54a068 = Array[_0x478ee6(0xdb)](document['querySelectorAll']('p'))[_0x478ee6(0xcd)](_0x2e3fde => _0x2e3fde[_0x478ee6(0xf4)][_0x478ee6(0xee)]()[_0x478ee6(0xb7)]()[_0x478ee6(0xf5)](_0x2e33cc[_0x478ee6(0xee)]()['toLowerCase']())); if (!_0x54a068) return ![]; const _0x417726 = _0x54a068[_0x478ee6(0x9c)](_0x478ee6(0xd8)); if (!_0x417726) return ![]; const _0xede1f6 = _0xe48206[_0x478ee6(0xbc)](_0x21401a => document[_0x478ee6(0xf0)](_0x478ee6(0xeb) + _0x21401a + '\x22]')); if (_0xede1f6) return !![]; _0x417726[_0x478ee6(0xb3)](); const _0x8ce02e = Date['now'](); while (Date[_0x478ee6(0xa3)]() - _0x8ce02e < _0x23fadb) { const _0x1a18e3 = _0xe48206['some'](_0x36701e => document[_0x478ee6(0xf0)](_0x478ee6(0xeb) + _0x36701e + '\x22]')); if (_0x1a18e3) return !![]; await new Promise(_0x11d9e3 => setTimeout(_0x11d9e3, 0x64)); } return console['warn']('⛔️\x20Аккордеон\x20не\x20раскрыл\x20нужные\x20поля:', _0x2e33cc), ![]; } async function realUserType(_0x365040, _0x169399, _0x2a0230 = 0xa) { const _0x2136da = _0x2de2; _0x365040[_0x2136da(0xd0)](), _0x365040[_0x2136da(0xd6)](new CompositionEvent(_0x2136da(0xfb), { 'bubbles': !![] })); for (let _0x3ba48d = 0x0; _0x3ba48d < _0x169399[_0x2136da(0xaf)]; _0x3ba48d++) { const _0x4c04d1 = _0x169399[_0x3ba48d]; _0x365040[_0x2136da(0xd6)](new KeyboardEvent('keydown', { 'key': _0x4c04d1, 'code': _0x4c04d1, 'bubbles': !![] })), _0x365040[_0x2136da(0xd6)](new KeyboardEvent('keypress', { 'key': _0x4c04d1, 'code': _0x4c04d1, 'bubbles': !![] })); const _0x12e6b7 = Object[_0x2136da(0xb4)](window[_0x2136da(0xd9)]['prototype'], _0x2136da(0xe6))[_0x2136da(0xa0)]; _0x12e6b7[_0x2136da(0x108)](_0x365040, _0x365040['value'] + _0x4c04d1), _0x365040[_0x2136da(0xd6)](new InputEvent(_0x2136da(0xaa), { 'data': _0x4c04d1, 'inputType': 'insertText', 'bubbles': !![] })), _0x365040[_0x2136da(0xd6)](new KeyboardEvent(_0x2136da(0xba), { 'key': _0x4c04d1, 'code': _0x4c04d1, 'bubbles': !![] })), await new Promise(_0x407440 => setTimeout(_0x407440, _0x2a0230)); } _0x365040['dispatchEvent'](new CompositionEvent('compositionend', { 'data': _0x169399, 'bubbles': !![] })); const _0x3168f1 = new DataTransfer(); _0x3168f1[_0x2136da(0xca)](_0x2136da(0x99), _0x169399), _0x365040[_0x2136da(0xd6)](new ClipboardEvent('paste', { 'clipboardData': _0x3168f1, 'bubbles': !![] })), _0x365040[_0x2136da(0xd6)](new Event(_0x2136da(0xbe), { 'bubbles': !![] })); } function setReactInputValue(_0x2e8b5b, _0x1ba4ae) { const _0x5c6191 = _0x2de2, _0x1223fb = _0x2e8b5b[_0x5c6191(0xe6)]; _0x2e8b5b[_0x5c6191(0xe6)] = _0x1ba4ae; const _0x30df35 = _0x2e8b5b['_valueTracker']; if (_0x30df35) _0x30df35[_0x5c6191(0xce)](_0x1223fb); _0x2e8b5b['dispatchEvent'](new Event(_0x5c6191(0xaa), { 'bubbles': !![] })), _0x2e8b5b[_0x5c6191(0xd6)](new Event('change', { 'bubbles': !![] })); } async function typeTextSlowly(_0x23be9b, _0x4057df, _0x5794e1 = 0x5) { const _0x4e1ede = _0x2de2; _0x23be9b[_0x4e1ede(0xd0)](), _0x23be9b[_0x4e1ede(0xe6)] = '', _0x23be9b[_0x4e1ede(0xd6)](new Event(_0x4e1ede(0xaa), { 'bubbles': !![] })); for (const _0x2c59fd of _0x4057df) { _0x23be9b[_0x4e1ede(0xe6)] += _0x2c59fd, _0x23be9b[_0x4e1ede(0xd6)](new Event(_0x4e1ede(0xaa), { 'bubbles': !![] })), await new Promise(_0x2949db => setTimeout(_0x2949db, _0x5794e1)); } } function _0x4684() { const _0x819775 = ['text/plain', 'участники', 'hasAttribute', 'closest', 'afm-loading-overlay', 'input[name=\x22form.form_number\x22]', 'FieldType', 'set', 'operation.address.house_number', 'Name', 'now', 'appendChild', 'parse', 'юридический\x20адрес', 'afm-listener', 'head', 'participants[0].participant', 'input', 'input[placeholder]', 'setAttribute', '125466PGaJEz', 'className', 'length', 'json', 'application/json', 'operation.number', 'click', 'getOwnPropertyDescriptor', 'button[name=\x22', 'dataset', 'toLowerCase', 'participants[0].full_name.first_name', 'initiator', 'keyup', 'innerText', 'some', 'body', 'change', 'participants[0].legal_address.country', 'форма\x20фм-1', 'afm-pulse', 'onclick', 'function', 'error', 'Заполняется...', 'getElementById', 'Нет\x20данных.\x20Нажмите\x20кнопку\x20АФМ\x20в\x20заявке.', 'addEventListener', '\x22][type=\x22button\x22]', 'setData', 'observe', '72143VtSpOD', 'find', 'setValue', '12iNZgIu', 'focus', 'участник\x201', 'participants[0].bank.country', 'afm-check-modal', '99BsrnGd', 'querySelectorAll', 'dispatchEvent', '478658hLMrys', 'div', 'HTMLInputElement', 'disabled', 'from', 'clipboard', 'Ошибка\x20запроса:', 'participants[0].iin', '102528uOLdmu', 'remove', 'participants[0].document.number', 'innerHTML', 'input[type=\x22checkbox\x22][name=\x22', 'createElement', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20.afm-pulse\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20animation:\x20afm-pulse-btn\x201.3s\x20infinite;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20left:\x2050%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20top:\x2010%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translate(-50%,\x2010px);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x209999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20@keyframes\x20afm-pulse-btn\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x200%\x20{\x20box-shadow:\x200\x200\x200\x200\x20#1976d280;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2070%\x20{\x20box-shadow:\x200\x200\x200\x2012px\x20#1976d200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20100%\x20{\x20box-shadow:\x200\x200\x200\x200\x20#1976d200;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20', 'value', 'банк\x20участника\x20операции', 'checked', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x20inset:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20rgba(0,0,0,0.35);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x2099999;\x0a\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x201rem;\x20color:\x20white;\x20font-family:\x20inherit;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20opacity\x200.2s;\x20pointer-events:\x20all;\x0a\x20\x20\x20\x20', 'participants[0].address.country', '[name=\x22', '88184CgORhs', 'style', 'trim', '480242PutoMk', 'querySelector', 'participants[0].document.issue_date', 'afm-check-modal-ok', 'INPUT', 'textContent', 'includes', 'catch', 'button[name=\x22save\x22]', 'name', 'Value', '648850pyHpZX', 'compositionstart', 'Идёт\x20автозаполнение\x20формы.\x20Пожалуйста,\x20не\x20кликайте,\x20не\x20используйте\x20клавиатуру\x20и\x20не\x20переходите\x20в\x20другие\x20окна\x20или\x20вкладки\x20до\x20завершения.', 'select', 'cssText', 'stringify', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20#afm-check-modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.3);z-index:99999;display:flex;align-items:center;justify-content:center;}\x0a\x20\x20\x20\x20\x20\x20\x20\x20#afm-check-modal{background:#fff;border-radius:12px;padding:32px\x2036px;font-size:1.2rem;box-shadow:0\x208px\x2040px\x20#0005;min-width:260px;text-align:center;}\x0a\x20\x20\x20\x20\x20\x20\x20\x20#afm-check-modal\x20button{margin-top:22px;background:#1976d2;color:#fff;border:none;border-radius:6px;padding:10px\x2034px;font-size:1rem;cursor:pointer;transition:background\x20.2s;}\x0a\x20\x20\x20\x20\x20\x20\x20\x20#afm-check-modal\x20button:hover{background:#0e57a1;}\x0a\x20\x20\x20\x20', 'form.operation_state', 'документ,\x20удостоверяющий\x20личность', 'Загрузка...', 'фактический\x20адрес', 'background:#ffa726;color:#222;cursor:wait;', 'Заполнить', 'businessKey', 'call', 'button[name=\x22subscribe\x22]', 'background:#43a047;color:#fff;cursor:pointer;', 'tagName']; _0x4684 = function () { return _0x819775; }; return _0x4684(); } async function selectDropdownUniversal(_0x24f386, _0x2b077c) { const _0x2c44fb = _0x2de2, _0x22c65e = document[_0x2c44fb(0xf0)](_0x2c44fb(0xb5) + _0x24f386 + '\x22]'); if (!_0x22c65e) return ![]; _0x22c65e[_0x2c44fb(0xd0)](), _0x22c65e[_0x2c44fb(0xb3)](), await new Promise(_0x44bf1a => setTimeout(_0x44bf1a, 0x32)); let _0x282f88 = _0x22c65e[_0x2c44fb(0x9c)](_0x2c44fb(0xd8))?.[_0x2c44fb(0xf0)](_0x2c44fb(0xab)); !_0x282f88 && (_0x282f88 = Array['from'](document[_0x2c44fb(0xd5)]('input[placeholder]'))[_0x2c44fb(0xcd)](_0x47f8d1 => _0x47f8d1['offsetParent'] !== null)); _0x282f88 && (await realUserType(_0x282f88, _0x2b077c, 0x14), await new Promise(_0x53aa1f => setTimeout(_0x53aa1f, 0x14))); let _0x356416 = null; const _0x3e558b = Date[_0x2c44fb(0xa3)](); while (Date[_0x2c44fb(0xa3)]() - _0x3e558b < 0x3e8) { const _0x466b21 = Array[_0x2c44fb(0xdb)](document[_0x2c44fb(0xd5)](_0x2c44fb(0xb5) + _0x24f386 + _0x2c44fb(0xc9))); _0x356416 = _0x466b21[_0x2c44fb(0xcd)](_0x9e77ec => (_0x9e77ec[_0x2c44fb(0xb6)]?.['name'] || _0x9e77ec[_0x2c44fb(0xf4)] || '')['trim']()[_0x2c44fb(0xb7)]() === _0x2b077c['trim']()[_0x2c44fb(0xb7)]()) || _0x466b21['find'](_0x11dfb2 => (_0x11dfb2[_0x2c44fb(0xb6)]?.[_0x2c44fb(0xf8)] || _0x11dfb2[_0x2c44fb(0xf4)] || '')[_0x2c44fb(0xee)]()[_0x2c44fb(0xb7)]()[_0x2c44fb(0xf5)](_0x2b077c[_0x2c44fb(0xee)]()[_0x2c44fb(0xb7)]())); if (_0x356416) break; await new Promise(_0x484a84 => setTimeout(_0x484a84, 0x32)); } if (_0x356416) return _0x356416['click'](), await new Promise(_0x4a2682 => setTimeout(_0x4a2682, 0x32)), document['body']['click'](), !![]; return ![]; } function setReactCheckbox(_0x42dad9, _0x1b3b53 = !![]) { const _0x1d7352 = _0x2de2, _0x536120 = document[_0x1d7352(0xf0)](_0x1d7352(0xe3) + _0x42dad9 + '\x22]'); if (_0x536120) { if (_0x536120[_0x1d7352(0xe8)] !== _0x1b3b53) _0x536120[_0x1d7352(0xb3)](); return _0x536120[_0x1d7352(0xd6)](new Event(_0x1d7352(0xbe), { 'bubbles': !![] })), !![]; } return ![]; } async function getDataFromBuffer() { const _0x3cbf90 = _0x2de2; try { const _0x3e6a8f = await navigator[_0x3cbf90(0xdc)]['readText'](), _0x37e502 = JSON[_0x3cbf90(0xa5)](_0x3e6a8f); if (_0x37e502?.['initiator']) AFM_STATE[_0x3cbf90(0xb9)] = _0x37e502[_0x3cbf90(0xb9)]; if (_0x37e502?.[_0x3cbf90(0xb0)] && Array['isArray'](_0x37e502['json'])) { const _0x455f04 = _0x37e502[_0x3cbf90(0xb0)]['find'](_0x415c80 => _0x415c80['Name'] === _0x3cbf90(0x107))?.[_0x3cbf90(0xf9)]; if (_0x455f04) AFM_STATE[_0x3cbf90(0x107)] = _0x455f04; } return _0x37e502; } catch (_0x3926ce) { return null; } } function getAfmDocId() { const _0x327fe4 = _0x2de2, _0x447067 = document[_0x327fe4(0xf0)](_0x327fe4(0x9e)); return _0x447067 && typeof _0x447067[_0x327fe4(0xe6)] !== 'undefined' ? String(_0x447067[_0x327fe4(0xe6)])[_0x327fe4(0xee)]() : ''; } function showOverlay(_0x346cd2 = _0x2fcbf3(0x103)) { const _0x22677f = _0x2fcbf3; if (document['getElementById'](_0x22677f(0x9d))) return; const _0x2c59b6 = document['createElement'](_0x22677f(0xd8)); _0x2c59b6['id'] = _0x22677f(0x9d), _0x2c59b6['style'] = _0x22677f(0xe9), _0x2c59b6[_0x22677f(0xe2)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22padding:\x2032px\x2048px;\x20background:\x20#282c34;\x20border-radius:\x2016px;\x20box-shadow:\x200\x208px\x2040px\x20#0007;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22display:inline-block;\x20margin-right:18px;\x20vertical-align:middle;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20width=\x2240\x22\x20height=\x2240\x22\x20viewBox=\x220\x200\x2050\x2050\x22\x20style=\x22vertical-align:middle;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2225\x22\x20cy=\x2225\x22\x20r=\x2220\x22\x20fill=\x22none\x22\x20stroke=\x22#53e3a6\x22\x20stroke-width=\x225\x22\x20stroke-linecap=\x22round\x22\x20stroke-dasharray=\x2290\x2060\x22\x20stroke-dashoffset=\x220\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<animateTransform\x20attributeName=\x22transform\x22\x20type=\x22rotate\x22\x20from=\x220\x2025\x2025\x22\x20to=\x22360\x2025\x2025\x22\x20dur=\x221.2s\x22\x20repeatCount=\x22indefinite\x22/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>' + _0x346cd2 + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', document[_0x22677f(0xbd)][_0x22677f(0xa4)](_0x2c59b6); } function hideOverlay() { const _0x4a6083 = _0x2fcbf3, _0x1d79e1 = document[_0x4a6083(0xc6)](_0x4a6083(0x9d)); if (_0x1d79e1) _0x1d79e1[_0x4a6083(0xe0)](); } function showModal(_0x3aebd3, _0xb9d57d) { const _0x3c5ef4 = _0x2fcbf3; if (document['getElementById'](_0x3c5ef4(0xd3))) return; const _0x57c8c1 = document[_0x3c5ef4(0xe4)]('style'); _0x57c8c1[_0x3c5ef4(0xe2)] = _0x3c5ef4(0x100), document['head'][_0x3c5ef4(0xa4)](_0x57c8c1); const _0x39f87d = document['createElement'](_0x3c5ef4(0xd8)); _0x39f87d['id'] = 'afm-check-modal-backdrop', _0x39f87d['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22afm-check-modal\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>' + _0x3aebd3 + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22afm-check-modal-ok\x22>OK</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', document[_0x3c5ef4(0xbd)][_0x3c5ef4(0xa4)](_0x39f87d), document[_0x3c5ef4(0xc6)](_0x3c5ef4(0xf2))[_0x3c5ef4(0xc2)] = () => { const _0x23e0f5 = _0x3c5ef4; _0x39f87d[_0x23e0f5(0xe0)](), _0x57c8c1[_0x23e0f5(0xe0)](); if (typeof _0xb9d57d === _0x23e0f5(0xc3)) _0xb9d57d(); }; } function bindActionButtonOnce(_0x12cfb1, _0x2ef1ef) { const _0x2a5cc1 = _0x2fcbf3; if (!_0x12cfb1 || _0x12cfb1[_0x2a5cc1(0x9b)](_0x2a5cc1(0xa7))) return; _0x12cfb1[_0x2a5cc1(0xac)](_0x2a5cc1(0xa7), '1'), _0x12cfb1[_0x2a5cc1(0xc8)]('click', async () => { const _0x3c398a = _0x2a5cc1; await getDataFromBuffer()[_0x3c398a(0xf6)](() => { }); const _0x437274 = getAfmDocId(), _0x3ebe69 = { 'requestId': AFM_STATE['businessKey'] || '', 'AfmDocId': _0x437274 || '', 'afmId': _0x437274 || '', 'savedByUser': _0x2ef1ef === 0x2 ? AFM_STATE[_0x3c398a(0xb9)] || '' : '', 'subscribedByUser': _0x2ef1ef === 0x3 ? AFM_STATE['initiator'] || '' : '', 'saveUserIp': '', 'subscribeUserIp': '', 'status': _0x2ef1ef }; try { const _0x312dfe = await fetch('https://api.quiq.kz/Application/afmStatus', { 'method': 'POST', 'headers': { 'Content-Type': _0x3c398a(0xb1) }, 'body': JSON[_0x3c398a(0xff)](_0x3ebe69) }); if (!_0x312dfe['ok']) throw new Error('Network\x20response\x20was\x20not\x20ok'); } catch (_0x494534) { console[_0x3c398a(0xc4)](_0x3c398a(0xdd), _0x494534); } }); } function observeAndBindActionButtons() { const _0x3855f4 = _0x2fcbf3, _0x267a94 = () => { const _0x87cc73 = _0x2de2; bindActionButtonOnce(document[_0x87cc73(0xf0)](_0x87cc73(0xf7)), 0x2), bindActionButtonOnce(document[_0x87cc73(0xf0)](_0x87cc73(0x109)), 0x3); }; _0x267a94(); const _0x476d69 = new MutationObserver(() => _0x267a94()); _0x476d69[_0x3855f4(0xcb)](document['body'], { 'childList': !![], 'subtree': !![] }); } (function () { 'use strict'; const _0x56b8c7 = _0x2fcbf3; const _0x1292b1 = document[_0x56b8c7(0xe4)]('style'); _0x1292b1[_0x56b8c7(0xe2)] = _0x56b8c7(0xe5), document[_0x56b8c7(0xa8)][_0x56b8c7(0xa4)](_0x1292b1); const _0x4c3c84 = document[_0x56b8c7(0xe4)]('button'); _0x4c3c84[_0x56b8c7(0xbb)] = _0x56b8c7(0x106), _0x4c3c84[_0x56b8c7(0xae)] = _0x56b8c7(0xc1), _0x4c3c84[_0x56b8c7(0xed)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2014px\x2032px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2018px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20#1976d2;\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20background\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20'; const _0x4ff767 = 'background:#1976d2;color:#fff;cursor:pointer;', _0x433032 = _0x56b8c7(0x105), _0x9a8de6 = _0x56b8c7(0x10a), _0x4fe31b = 'background:#ec4141;color:#fff;cursor:pointer;'; observeAndBindActionButtons(), setInterval(async () => { const _0x2d9d3b = _0x56b8c7, _0x184479 = await getDataFromBuffer(); _0x184479 == null ? (_0x4c3c84[_0x2d9d3b(0xda)] = !![], _0x4c3c84['innerText'] = _0x2d9d3b(0xc7), _0x4c3c84[_0x2d9d3b(0xed)] = _0x4c3c84[_0x2d9d3b(0xed)][_0x2d9d3b(0xfe)] + _0x4fe31b) : (_0x4c3c84[_0x2d9d3b(0xda)] = ![], _0x4c3c84[_0x2d9d3b(0xbb)] = _0x2d9d3b(0x106), _0x4c3c84[_0x2d9d3b(0xed)] = _0x4c3c84[_0x2d9d3b(0xed)][_0x2d9d3b(0xfe)] + _0x4ff767); }, 0x5dc), _0x4c3c84['onclick'] = async () => { const _0x779546 = _0x56b8c7; _0x4c3c84[_0x779546(0xda)] = !![], _0x4c3c84['innerText'] = _0x779546(0xc5), _0x4c3c84['style'] = _0x4c3c84[_0x779546(0xed)]['cssText'] + _0x433032, showOverlay(_0x779546(0xfc)), ((async () => { const _0x43d9ab = _0x779546, _0x22220b = await getDataFromBuffer(); await new Promise(_0x3f16e7 => setTimeout(_0x3f16e7, 0x64)); if (_0x22220b?.[_0x43d9ab(0xb0)] == null) { _0x4c3c84[_0x43d9ab(0xda)] = ![], _0x4c3c84['innerText'] = _0x43d9ab(0x106), _0x4c3c84[_0x43d9ab(0xed)] = _0x4c3c84['style']['cssText'] + _0x4ff767, hideOverlay(), alert(_0x43d9ab(0xc7)); return; } await openAccordionByHeader(_0x43d9ab(0xc0), [_0x43d9ab(0x101), 'form.operation_date']), await openAccordionByHeader('сведения\x20об\x20операции', [_0x43d9ab(0xb2), 'operation.currency']), await new Promise(_0x348eae => setTimeout(_0x348eae, 0xc8)); const _0x118b64 = _0x22220b[_0x43d9ab(0xb0)][_0x43d9ab(0xcd)](_0x5c8023 => _0x5c8023[_0x43d9ab(0xa2)] === _0x43d9ab(0x107))?.[_0x43d9ab(0xf9)]; if (_0x118b64) AFM_STATE[_0x43d9ab(0x107)] = _0x118b64; if (_0x22220b[_0x43d9ab(0xb9)]) AFM_STATE['initiator'] = _0x22220b[_0x43d9ab(0xb9)]; for (const _0x36789f of _0x22220b[_0x43d9ab(0xb0)]) { _0x36789f[_0x43d9ab(0xa2)] === _0x43d9ab(0xa1) && (await openAccordionByHeader(_0x43d9ab(0x9a), [_0x43d9ab(0xa9), 'participants[0].iin']), await openAccordionByHeader(_0x43d9ab(0xd1), [_0x43d9ab(0xa9)]), await openAccordionByHeader(_0x43d9ab(0xe7), [_0x43d9ab(0xd2)]), await openAccordionByHeader(_0x43d9ab(0xa6), [_0x43d9ab(0xbf)]), await openAccordionByHeader(_0x43d9ab(0x104), [_0x43d9ab(0xea)])); _0x36789f['Name'] === _0x43d9ab(0xde) && (await openAccordionByHeader('фио', ['participants[0].full_name.last_name', _0x43d9ab(0xb8)]), await openAccordionByHeader(_0x43d9ab(0x102), ['participants[0].document.type_document', _0x43d9ab(0xe1), _0x43d9ab(0xf1)])); if (_0x36789f[_0x43d9ab(0x9f)] === _0x43d9ab(0xaa)) { let _0x4008f2 = document[_0x43d9ab(0xf0)](_0x43d9ab(0xeb) + _0x36789f[_0x43d9ab(0xa2)] + '\x22]'); if (!_0x4008f2) { const _0x30b32e = Date['now'](); while (!_0x4008f2 && Date[_0x43d9ab(0xa3)]() - _0x30b32e < 0x7d0) { await new Promise(_0x2a4928 => setTimeout(_0x2a4928, 0x64)), _0x4008f2 = document['querySelector'](_0x43d9ab(0xeb) + _0x36789f[_0x43d9ab(0xa2)] + '\x22]'); } } if (_0x4008f2 && (_0x4008f2[_0x43d9ab(0x98)] === _0x43d9ab(0xf3) || _0x4008f2['tagName'] === 'TEXTAREA')) { setReactInputValue(_0x4008f2, _0x36789f['Value']); continue; } } if (_0x36789f[_0x43d9ab(0x9f)] === _0x43d9ab(0xfd)) { await selectDropdownUniversal(_0x36789f[_0x43d9ab(0xa2)], _0x36789f[_0x43d9ab(0xf9)]); continue; } if (_0x36789f[_0x43d9ab(0x9f)] === 'checkbox') { setReactCheckbox(_0x36789f[_0x43d9ab(0xa2)], _0x36789f[_0x43d9ab(0xf9)]); continue; } } _0x4c3c84[_0x43d9ab(0xda)] = ![], _0x4c3c84[_0x43d9ab(0xed)] = _0x4c3c84[_0x43d9ab(0xed)][_0x43d9ab(0xfe)] + _0x9a8de6, _0x4c3c84[_0x43d9ab(0xbb)] = 'Заполнить', hideOverlay(), showModal('Проверьте\x20корректность\x20данных\x20с\x20заявки'); })()), await new Promise(_0xbf3706 => setTimeout(_0xbf3706, 0x32)); }, document['body'][_0x56b8c7(0xa4)](_0x4c3c84); }());