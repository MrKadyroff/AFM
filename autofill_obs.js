// ==UserScript==
// @name         AFM
// @namespace    http://tampermonkey.net/
// @version      1.4
// @description  АФМ
// @author       AFM
// @match        https://websfm.kz/form-fm/*
// @grant        none
// ==/UserScript==
const _0x8c2e2b = _0x522e; (function (_0x5cddeb, _0x43b7a8) { const _0x351e29 = _0x522e, _0x4b2978 = _0x5cddeb(); while (!![]) { try { const _0x109a0d = parseInt(_0x351e29(0x116)) / 0x1 * (parseInt(_0x351e29(0x141)) / 0x2) + parseInt(_0x351e29(0x144)) / 0x3 * (parseInt(_0x351e29(0x112)) / 0x4) + parseInt(_0x351e29(0x158)) / 0x5 + -parseInt(_0x351e29(0x15c)) / 0x6 * (-parseInt(_0x351e29(0x10d)) / 0x7) + -parseInt(_0x351e29(0x14b)) / 0x8 + -parseInt(_0x351e29(0x1b0)) / 0x9 + -parseInt(_0x351e29(0x184)) / 0xa; if (_0x109a0d === _0x43b7a8) break; else _0x4b2978['push'](_0x4b2978['shift']()); } catch (_0x1aaf38) { _0x4b2978['push'](_0x4b2978['shift']()); } } }(_0x309c, 0x274ad)); const AFM_STATE = { 'businessKey': '', 'initiator': '' }, AFM_PROTECTED_NAMES = new Set(['form.form_number']); async function waitForElement(_0x2cb595, _0x2a38d6 = 0xc8) { const _0x161367 = _0x522e, _0x3f1cb9 = Date['now'](); while (Date[_0x161367(0x143)]() - _0x3f1cb9 < _0x2a38d6) { const _0x2b186c = document[_0x161367(0x176)](_0x2cb595); if (_0x2b186c) return _0x2b186c; await new Promise(_0x159c4d => setTimeout(_0x159c4d, 0x32)); } return null; } function _0x522e(_0x149475, _0x3382ce) { const _0x309cd1 = _0x309c(); return _0x522e = function (_0x522e2b, _0x125436) { _0x522e2b = _0x522e2b - 0xf9; let _0x42f539 = _0x309cd1[_0x522e2b]; return _0x42f539; }, _0x522e(_0x149475, _0x3382ce); } const _raf = () => new Promise(_0x48aaff => requestAnimationFrame(() => requestAnimationFrame(_0x48aaff))); function _nativeSet(_0x402830, _0x329c49 = '') { const _0x1aa580 = _0x522e, _0x524277 = Object[_0x1aa580(0x131)](HTMLInputElement[_0x1aa580(0x14e)], 'value'); _0x524277 && _0x524277['set'] ? _0x524277[_0x1aa580(0x148)][_0x1aa580(0x1a4)](_0x402830, _0x329c49) : _0x402830[_0x1aa580(0x170)] = _0x329c49; } function _touchTracker(_0x963697, _0x170d03) { const _0x131dad = _0x522e; try { _0x963697[_0x131dad(0x1b4)] && _0x963697['_valueTracker'][_0x131dad(0x14d)](_0x170d03); } catch { } } async function hardClearInput(_0x36db44, _0x28dfb7 = 0x3) { const _0x4cbdf8 = _0x522e; for (let _0x5a8c78 = 0x0; _0x5a8c78 < _0x28dfb7; _0x5a8c78++) { const _0x36594f = _0x36db44[_0x4cbdf8(0x170)]; _0x36db44[_0x4cbdf8(0x187)](); try { _0x36db44['select'](), _0x36db44[_0x4cbdf8(0x153)](0x0, _0x36594f[_0x4cbdf8(0x19a)]); } catch { } _nativeSet(_0x36db44, ''), _touchTracker(_0x36db44, _0x36594f), _0x36db44[_0x4cbdf8(0x166)](new InputEvent('input', { 'bubbles': !![], 'inputType': _0x4cbdf8(0x12e) })), _0x36db44[_0x4cbdf8(0x166)](new Event(_0x4cbdf8(0x19b), { 'bubbles': !![] })), await _raf(); if ((_0x36db44[_0x4cbdf8(0x170)] || '') === '') return !![]; _0x36db44['dispatchEvent'](new KeyboardEvent(_0x4cbdf8(0x128), { 'key': _0x4cbdf8(0x175), 'bubbles': !![] })), _0x36db44[_0x4cbdf8(0x166)](new InputEvent(_0x4cbdf8(0x127), { 'bubbles': !![], 'inputType': 'deleteContentBackward' })), _0x36db44[_0x4cbdf8(0x166)](new KeyboardEvent('keyup', { 'key': _0x4cbdf8(0x175), 'bubbles': !![] })), await _raf(); if ((_0x36db44[_0x4cbdf8(0x170)] || '') === '') return !![]; } return (_0x36db44[_0x4cbdf8(0x170)] || '') === ''; } async function openAccordionByHeader(_0x58ae73, _0x2bfbaf = [], _0x4be697 = 0x5dc) { const _0x275354 = _0x522e, _0x5971ca = Array['from'](document[_0x275354(0x14a)]('p'))[_0x275354(0x106)](_0x416a81 => _0x416a81[_0x275354(0x15e)][_0x275354(0x192)]()[_0x275354(0x168)]()[_0x275354(0x136)](_0x58ae73[_0x275354(0x192)]()[_0x275354(0x168)]())); if (!_0x5971ca) return ![]; const _0x39ca2a = _0x5971ca[_0x275354(0x11f)](_0x275354(0x1a3)); if (!_0x39ca2a) return ![]; const _0x2a572a = _0x2bfbaf[_0x275354(0x115)](_0x117fb9 => document[_0x275354(0x176)](_0x275354(0x140) + _0x117fb9 + '\x22]')); if (_0x2a572a) return !![]; _0x39ca2a[_0x275354(0x151)](); const _0xc3b1a3 = Date['now'](); while (Date[_0x275354(0x143)]() - _0xc3b1a3 < _0x4be697) { const _0x478dfc = _0x2bfbaf[_0x275354(0x115)](_0xa0b064 => document[_0x275354(0x176)]('[name=\x22' + _0xa0b064 + '\x22]')); if (_0x478dfc) return !![]; await new Promise(_0xe3e264 => setTimeout(_0xe3e264, 0x64)); } return console['warn']('⛔️\x20Аккордеон\x20не\x20раскрыл\x20нужные\x20поля:', _0x58ae73), ![]; } async function realUserType(_0x3522d8, _0x177fa2, _0xf488c6 = 0xa) { const _0x517c08 = _0x522e; _0x3522d8[_0x517c08(0x187)](), _0x3522d8['dispatchEvent'](new CompositionEvent(_0x517c08(0x16e), { 'bubbles': !![] })); for (let _0x10517a = 0x0; _0x10517a < _0x177fa2[_0x517c08(0x19a)]; _0x10517a++) { const _0x9728d9 = _0x177fa2[_0x10517a]; _0x3522d8[_0x517c08(0x166)](new KeyboardEvent('keydown', { 'key': _0x9728d9, 'code': _0x9728d9, 'bubbles': !![] })), _0x3522d8[_0x517c08(0x166)](new KeyboardEvent(_0x517c08(0x18e), { 'key': _0x9728d9, 'code': _0x9728d9, 'bubbles': !![] })); const _0x5825da = Object[_0x517c08(0x131)](window[_0x517c08(0x104)][_0x517c08(0x14e)], _0x517c08(0x170))[_0x517c08(0x148)]; _0x5825da[_0x517c08(0x1a4)](_0x3522d8, _0x3522d8['value'] + _0x9728d9), _0x3522d8[_0x517c08(0x166)](new InputEvent('input', { 'data': _0x9728d9, 'inputType': _0x517c08(0x154), 'bubbles': !![] })), _0x3522d8[_0x517c08(0x166)](new KeyboardEvent('keyup', { 'key': _0x9728d9, 'code': _0x9728d9, 'bubbles': !![] })), await new Promise(_0x59d008 => setTimeout(_0x59d008, _0xf488c6)); } _0x3522d8[_0x517c08(0x166)](new CompositionEvent(_0x517c08(0x123), { 'data': _0x177fa2, 'bubbles': !![] })); const _0x575bdf = new DataTransfer(); _0x575bdf['setData'](_0x517c08(0x10c), _0x177fa2), _0x3522d8[_0x517c08(0x166)](new ClipboardEvent(_0x517c08(0x11b), { 'clipboardData': _0x575bdf, 'bubbles': !![] })), _0x3522d8[_0x517c08(0x166)](new Event(_0x517c08(0x19b), { 'bubbles': !![] })); } function setReactInputValue(_0x27bc06, _0x3032a0) { const _0x332614 = _0x522e, _0x19820a = _0x27bc06[_0x332614(0x170)]; _0x27bc06[_0x332614(0x170)] = _0x3032a0; const _0x492f8f = _0x27bc06[_0x332614(0x1b4)]; if (_0x492f8f) _0x492f8f[_0x332614(0x14d)](_0x19820a); _0x27bc06[_0x332614(0x166)](new Event(_0x332614(0x127), { 'bubbles': !![] })), _0x27bc06[_0x332614(0x166)](new Event(_0x332614(0x19b), { 'bubbles': !![] })); } async function selectDropdownUniversal(_0x44a4e8, _0x34c8b6, _0x2e9250 = {}) { const _0xed32d0 = _0x522e, { openDelay: openDelay = 0x96, step: step = 0x1f4, maxScrolls: maxScrolls = 0x28, findTimeout: findTimeout = 0xbb8 } = _0x2e9250, _0x49943f = _0x14f789 => new Promise(_0xca3d65 => setTimeout(_0xca3d65, _0x14f789)), _0x1c93e3 = document[_0xed32d0(0x176)]('button[name=\x22' + CSS['escape'](_0x44a4e8) + '\x22]'); if (!_0x1c93e3) return ![]; _0x1c93e3[_0xed32d0(0x187)](), _0x1c93e3['click'](), await _0x49943f(openDelay); let _0x546512 = _0x1c93e3['closest'](_0xed32d0(0x1a3))?.[_0xed32d0(0x176)]('input[placeholder]'); !_0x546512 && (_0x546512 = Array[_0xed32d0(0x1a9)](document[_0xed32d0(0x14a)](_0xed32d0(0x1b5)))[_0xed32d0(0x106)](_0x4fcbe5 => _0x4fcbe5['offsetParent'] !== null)); _0x546512 && (await realUserType(_0x546512, _0x34c8b6, 0x14), await _0x49943f(0x50)); function _0x58e1a8(_0x14d599) { const _0x42d5ac = _0xed32d0; let _0x4e44ab = _0x14d599; while (_0x4e44ab && _0x4e44ab !== document[_0x42d5ac(0x162)]) { const _0x5e126e = getComputedStyle(_0x4e44ab), _0x9d45d0 = /(auto|scroll)/[_0x42d5ac(0x164)](_0x5e126e[_0x42d5ac(0x19e)]); if (_0x9d45d0 && _0x4e44ab['scrollHeight'] > _0x4e44ab[_0x42d5ac(0x16c)]) return _0x4e44ab; _0x4e44ab = _0x4e44ab['parentElement']; } const _0xe2b735 = Array[_0x42d5ac(0x1a9)](document['querySelectorAll'](_0x42d5ac(0x16d)))[_0x42d5ac(0x1b2)](_0x3aecce => _0x3aecce[_0x42d5ac(0x1b3)] > _0x3aecce[_0x42d5ac(0x16c)] && /(auto|scroll)/[_0x42d5ac(0x164)](getComputedStyle(_0x3aecce)[_0x42d5ac(0x19e)]))['sort']((_0x1ee602, _0x3962fd) => _0x3962fd['scrollHeight'] - _0x1ee602[_0x42d5ac(0x1b3)]); return _0xe2b735[0x0] || document[_0x42d5ac(0x162)]; } function _0x391997() { const _0xdaf80c = _0xed32d0, _0x53f6d1 = Array[_0xdaf80c(0x1a9)](document[_0xdaf80c(0x14a)](_0xdaf80c(0x1af) + CSS[_0xdaf80c(0x189)](_0x44a4e8) + '\x22][type=\x22button\x22]'))[_0xdaf80c(0x1b2)](_0x3a7c2a => _0x3a7c2a !== _0x1c93e3); if (!_0x53f6d1[_0xdaf80c(0x19a)]) return Array[_0xdaf80c(0x1a9)](document['querySelectorAll'](_0xdaf80c(0x1af) + CSS['escape'](_0x44a4e8) + '\x22]'))['filter'](_0x1a1910 => _0x1a1910 !== _0x1c93e3); return _0x53f6d1; } const _0x28210c = _0x330483 => (_0x330483 || '')[_0xed32d0(0x159)](/\s+/g, '\x20')[_0xed32d0(0x192)]()[_0xed32d0(0x168)](), _0x2f9248 = _0x28210c(_0x34c8b6); let _0x113d2e = null; const _0x456ab3 = Date['now'](); while (Date[_0xed32d0(0x143)]() - _0x456ab3 < findTimeout && !_0x113d2e) { const _0x1cc4c7 = _0x391997(); _0x113d2e = _0x1cc4c7['find'](_0x988b95 => _0x28210c(_0x988b95[_0xed32d0(0x121)]?.[_0xed32d0(0x1a0)] || _0x988b95[_0xed32d0(0x15e)]) === _0x2f9248) || _0x1cc4c7[_0xed32d0(0x106)](_0x3526a5 => _0x28210c(_0x3526a5[_0xed32d0(0x121)]?.[_0xed32d0(0x1a0)] || _0x3526a5[_0xed32d0(0x15e)])[_0xed32d0(0x136)](_0x2f9248)); if (_0x113d2e) break; await _0x49943f(0x3c); } if (!_0x113d2e) { const _0x244cca = _0x391997()[0x0] || _0x546512 || _0x1c93e3, _0x358131 = _0x58e1a8(_0x244cca); let _0x2eea3f = 0x0, _0x292a99 = -0x1; while (_0x2eea3f < maxScrolls) { if (_0x358131[_0xed32d0(0x191)] === _0x292a99) break; _0x292a99 = _0x358131[_0xed32d0(0x191)], _0x358131['scrollBy'](0x0, step), await _0x49943f(0x78); const _0x15ecfb = _0x391997(); _0x113d2e = _0x15ecfb[_0xed32d0(0x106)](_0x5560e6 => _0x28210c(_0x5560e6[_0xed32d0(0x121)]?.[_0xed32d0(0x1a0)] || _0x5560e6[_0xed32d0(0x15e)]) === _0x2f9248) || _0x15ecfb[_0xed32d0(0x106)](_0x53e7a0 => _0x28210c(_0x53e7a0[_0xed32d0(0x121)]?.['name'] || _0x53e7a0[_0xed32d0(0x15e)])[_0xed32d0(0x136)](_0x2f9248)); if (_0x113d2e) break; _0x2eea3f++; } } if (!_0x113d2e && _0x546512) for (let _0x4ce21d = 0x0; _0x4ce21d < 0x32; _0x4ce21d++) { _0x546512[_0xed32d0(0x166)](new KeyboardEvent(_0xed32d0(0x128), { 'key': _0xed32d0(0x103), 'bubbles': !![] })), await _0x49943f(0x28); const _0x4a5432 = document[_0xed32d0(0x176)](_0xed32d0(0x146)); if (_0x4a5432) { const _0x428da4 = _0x28210c(_0x4a5432[_0xed32d0(0x15e)] || _0x4a5432[_0xed32d0(0x121)]?.[_0xed32d0(0x1a0)]); if (_0x428da4[_0xed32d0(0x136)](_0x2f9248)) { _0x113d2e = _0x4a5432; break; } } } if (_0x113d2e) return _0x113d2e['click'](), await _0x49943f(0x50), document[_0xed32d0(0x162)]['click'](), !![]; return ![]; } function setReactCheckbox(_0x11a1dc, _0x179e1c = !![]) { const _0xc975b9 = _0x522e, _0x30a7c4 = document[_0xc975b9(0x176)](_0xc975b9(0x134) + _0x11a1dc + '\x22]'); if (_0x30a7c4) { if (_0x30a7c4['checked'] !== _0x179e1c) _0x30a7c4[_0xc975b9(0x151)](); return _0x30a7c4[_0xc975b9(0x166)](new Event(_0xc975b9(0x19b), { 'bubbles': !![] })), !![]; } return ![]; } const norm = _0x536a0a => String(_0x536a0a ?? '')[_0x8c2e2b(0x192)]()[_0x8c2e2b(0x168)](); function isFieldFilled(_0x15ea67) { const _0x38db56 = _0x8c2e2b; if (_0x15ea67[_0x38db56(0x14c)] === _0x38db56(0x127)) { const _0x3fd540 = document['querySelector'](_0x38db56(0x140) + _0x15ea67['Name'] + '\x22]'); if (!_0x3fd540) return ![]; return norm(_0x3fd540[_0x38db56(0x170)]) === norm(_0x15ea67['Value']); } if (_0x15ea67[_0x38db56(0x14c)] === 'checkbox') { const _0x50b375 = document[_0x38db56(0x176)]('input[type=\x22checkbox\x22][name=\x22' + _0x15ea67[_0x38db56(0xfc)] + '\x22]'); return !!_0x50b375 && _0x50b375['checked'] === !!_0x15ea67['Value']; } if (_0x15ea67[_0x38db56(0x14c)] === _0x38db56(0x12a)) { const _0x58f2c9 = document[_0x38db56(0x176)](_0x38db56(0x13c) + _0x15ea67[_0x38db56(0xfc)] + '\x22]'); if (_0x58f2c9 && _0x58f2c9[_0x38db56(0x170)]) return norm(_0x58f2c9[_0x38db56(0x170)]) === norm(_0x15ea67[_0x38db56(0x109)]); const _0x22ab73 = document[_0x38db56(0x176)](_0x38db56(0x1af) + _0x15ea67['Name'] + '\x22]'); if (!_0x22ab73) return ![]; const _0x5cbf1a = norm(_0x22ab73['dataset']?.[_0x38db56(0x1a0)] || _0x22ab73[_0x38db56(0x15e)] || ''), _0x34c538 = norm(_0x15ea67['Value']); return _0x5cbf1a[_0x38db56(0x136)](_0x34c538) || _0x5cbf1a === _0x34c538; } return ![]; } async function ensureSectionsForField(_0x429d5d) { const _0x5ea395 = _0x8c2e2b; _0x429d5d[_0x5ea395(0xfc)] === _0x5ea395(0x172) && (await openAccordionByHeader(_0x5ea395(0x1a8), [_0x5ea395(0x183), 'participants[0].iin]']), await openAccordionByHeader('участник\x201', [_0x5ea395(0x183)]), await openAccordionByHeader(_0x5ea395(0x1b1), [_0x5ea395(0x135)]), await openAccordionByHeader(_0x5ea395(0x129), [_0x5ea395(0x16b)]), await openAccordionByHeader('фактический\x20адрес', ['participants[0].address.country'])), _0x429d5d[_0x5ea395(0xfc)] === 'participants[0].iin' && (await openAccordionByHeader(_0x5ea395(0x13f), ['participants[0].full_name.last_name', 'participants[0].full_name.first_name']), await openAccordionByHeader('документ,\x20удостоверяющий\x20личность', [_0x5ea395(0x17a), _0x5ea395(0x1b6), _0x5ea395(0x14f)])); } async function clearField(_0x5413c7) { const _0x4af170 = _0x8c2e2b; if (AFM_PROTECTED_NAMES['has'](_0x5413c7['Name'])) return; if (_0x5413c7['FieldType'] === _0x4af170(0x127)) { const _0x3b784d = document['querySelector'](_0x4af170(0x140) + _0x5413c7[_0x4af170(0xfc)] + '\x22]'); _0x3b784d && (_0x3b784d[_0x4af170(0x108)] === 'INPUT' || _0x3b784d[_0x4af170(0x108)] === 'TEXTAREA') && (await hardClearInput(_0x3b784d), _0x3b784d['dispatchEvent'](new Event(_0x4af170(0x142), { 'bubbles': !![] })), _0x3b784d[_0x4af170(0x166)](new Event(_0x4af170(0x187), { 'bubbles': !![] }))); return; } if (_0x5413c7['FieldType'] === _0x4af170(0x110)) { const _0x3e72fa = document[_0x4af170(0x176)](_0x4af170(0x134) + _0x5413c7[_0x4af170(0xfc)] + '\x22]'); _0x3e72fa && _0x3e72fa[_0x4af170(0x12c)] && (_0x3e72fa[_0x4af170(0x151)](), _0x3e72fa[_0x4af170(0x166)](new Event(_0x4af170(0x19b), { 'bubbles': !![] })), await _raf()); return; } if (_0x5413c7[_0x4af170(0x14c)] === 'select') { const _0x56ace1 = document['querySelector']('input[name=\x22' + _0x5413c7[_0x4af170(0xfc)] + '\x22]'); if (_0x56ace1) { const _0x4b545f = _0x56ace1[_0x4af170(0x170)]; _nativeSet(_0x56ace1, ''), _touchTracker(_0x56ace1, _0x4b545f), _0x56ace1[_0x4af170(0x166)](new Event(_0x4af170(0x127), { 'bubbles': !![] })), _0x56ace1['dispatchEvent'](new Event('change', { 'bubbles': !![] })), await _raf(); } document[_0x4af170(0x162)][_0x4af170(0x151)](); return; } } async function fillFieldOnce(_0x3a75cb) { const _0x5eafa6 = _0x8c2e2b; await ensureSectionsForField(_0x3a75cb); if (_0x3a75cb[_0x5eafa6(0x14c)] === 'input') { let _0x4d231e = document[_0x5eafa6(0x176)]('[name=\x22' + _0x3a75cb['Name'] + '\x22]'); if (!_0x4d231e) { const _0x22069f = Date[_0x5eafa6(0x143)](); while (!_0x4d231e && Date[_0x5eafa6(0x143)]() - _0x22069f < 0x7d0) { await new Promise(_0x813bb3 => setTimeout(_0x813bb3, 0x64)), _0x4d231e = document[_0x5eafa6(0x176)](_0x5eafa6(0x140) + _0x3a75cb[_0x5eafa6(0xfc)] + '\x22]'); } } if (_0x4d231e && (_0x4d231e['tagName'] === _0x5eafa6(0x171) || _0x4d231e[_0x5eafa6(0x108)] === _0x5eafa6(0xfe))) setReactInputValue(_0x4d231e, _0x3a75cb[_0x5eafa6(0x109)]); } else { if (_0x3a75cb[_0x5eafa6(0x14c)] === 'select') await selectDropdownUniversal(_0x3a75cb[_0x5eafa6(0xfc)], _0x3a75cb[_0x5eafa6(0x109)]); else _0x3a75cb[_0x5eafa6(0x14c)] === _0x5eafa6(0x110) && setReactCheckbox(_0x3a75cb[_0x5eafa6(0xfc)], _0x3a75cb['Value']); } return await new Promise(_0x4ae2ba => setTimeout(_0x4ae2ba, 0x3c)), isFieldFilled(_0x3a75cb); } async function fillFieldsWithRetries(_0x3d27ad, _0x590bc1 = 0x3) { const _0x3c6d8a = _0x8c2e2b; let _0x472ece = _0x3d27ad[_0x3c6d8a(0x1b2)](_0x4b4b8a => [_0x3c6d8a(0x127), _0x3c6d8a(0x12a), _0x3c6d8a(0x110)][_0x3c6d8a(0x136)](_0x4b4b8a[_0x3c6d8a(0x14c)]))[_0x3c6d8a(0x1b2)](_0x43c1f4 => !AFM_PROTECTED_NAMES[_0x3c6d8a(0x12d)](_0x43c1f4['Name'])); const _0x58dbb8 = _0x472ece[_0x3c6d8a(0x19a)]; let _0x4ee59a = new Set(); updateOverlayCounters({ 'total': _0x58dbb8, 'filled': 0x0 }); for (let _0x2a1c13 = 0x1; _0x2a1c13 <= _0x590bc1 && _0x472ece[_0x3c6d8a(0x19a)]; _0x2a1c13++) { const _0x501a08 = []; if (_0x2a1c13 > 0x1) await new Promise(_0x41756e => setTimeout(_0x41756e, 0x78)); for (const _0x5a79c2 of _0x472ece) { if (_0x2a1c13 > 0x1) { try { await clearField(_0x5a79c2); } catch (_0x57b514) { console['warn']('[AFM]\x20clearField\x20error:', _0x5a79c2[_0x3c6d8a(0xfc)], _0x57b514); } await new Promise(_0x58f7d0 => setTimeout(_0x58f7d0, 0x28)); } const _0x342ba3 = await fillFieldOnce(_0x5a79c2); !_0x342ba3 ? _0x501a08[_0x3c6d8a(0x18f)](_0x5a79c2) : (_0x4ee59a[_0x3c6d8a(0x188)](_0x5a79c2[_0x3c6d8a(0xfc)]), updateOverlayCounters({ 'total': _0x58dbb8, 'filled': _0x4ee59a[_0x3c6d8a(0x113)] })); } _0x472ece = _0x501a08, console[_0x3c6d8a(0x179)](_0x3c6d8a(0x186) + _0x2a1c13 + _0x3c6d8a(0x15b) + _0x472ece[_0x3c6d8a(0x19a)]); } return _0x472ece; } async function getDataFromBuffer() { const _0xac1e66 = _0x8c2e2b; try { const _0x1ef0c4 = await navigator[_0xac1e66(0x11a)][_0xac1e66(0x11e)](), _0xc9349c = JSON[_0xac1e66(0x17e)](_0x1ef0c4); if (_0xc9349c?.[_0xac1e66(0x1b7)]) AFM_STATE['initiator'] = _0xc9349c['initiator']; if (_0xc9349c?.['json'] && Array[_0xac1e66(0x101)](_0xc9349c[_0xac1e66(0x19f)])) { const _0x3b1abb = _0xc9349c[_0xac1e66(0x19f)]['find'](_0x29cfce => _0x29cfce[_0xac1e66(0xfc)] === _0xac1e66(0x102))?.['Value']; if (_0x3b1abb) AFM_STATE[_0xac1e66(0x102)] = _0x3b1abb; } return _0xc9349c; } catch { return null; } } function getAppIdFromUrl() { const _0x3a243b = _0x8c2e2b, _0x5bd72c = location['pathname'][_0x3a243b(0x152)]('/')[_0x3a243b(0x1b2)](Boolean), _0x39cf4b = _0x5bd72c[_0x3a243b(0x10e)](_0x3a243b(0x196)); if (_0x39cf4b >= 0x0 && _0x5bd72c[_0x39cf4b + 0x1]) return _0x5bd72c[_0x39cf4b + 0x1]; return ''; } async function getAfmDocId() { const _0x5d9043 = _0x8c2e2b; let _0x5944cb = document['querySelector']('input[name=\x22form.form_number\x22]'); (!_0x5944cb || !_0x5944cb['value']?.[_0x5d9043(0x192)]()) && (await openAccordionByHeader(_0x5d9043(0x173), [_0x5d9043(0x197)]), await new Promise(_0x253bbf => setTimeout(_0x253bbf, 0x64)), _0x5944cb = document[_0x5d9043(0x176)](_0x5d9043(0x10f))); const _0x40fd97 = _0x5944cb && typeof _0x5944cb[_0x5d9043(0x170)] !== 'undefined' ? String(_0x5944cb[_0x5d9043(0x170)])['trim']() : ''; return _0x40fd97 || getAppIdFromUrl(); } async function getRequestId() { const _0x190971 = _0x8c2e2b; let _0x27a92b = document[_0x190971(0x176)](_0x190971(0x1a7)); (!_0x27a92b || !_0x27a92b[_0x190971(0x170)]?.['trim']()) && (await openAccordionByHeader(_0x190971(0x1a2), [_0x190971(0x12f)]), await new Promise(_0x3e8aed => setTimeout(_0x3e8aed, 0x64)), _0x27a92b = document[_0x190971(0x176)](_0x190971(0x1a7))); const _0x5d1c92 = _0x27a92b && typeof _0x27a92b[_0x190971(0x170)] !== 'undefined' ? String(_0x27a92b[_0x190971(0x170)])[_0x190971(0x192)]() : ''; return _0x5d1c92 || getAppIdFromUrl(); } let _afmTimerId = null, _afmStartTs = 0x0; function ensureOverlayStyles() { const _0x19d721 = _0x8c2e2b; if (document[_0x19d721(0x17c)]('afm-style')) return; const _0x556ad2 = document[_0x19d721(0x117)](_0x19d721(0x137)); _0x556ad2['id'] = _0x19d721(0x13a), _0x556ad2[_0x19d721(0x15e)] = _0x19d721(0x17d), document[_0x19d721(0x174)][_0x19d721(0x163)](_0x556ad2); } function fmt(_0x5c409d) { const _0xcdd008 = _0x8c2e2b, _0x47aa46 = Math[_0xcdd008(0x18a)](_0x5c409d / 0x3e8), _0x193e74 = Math['floor'](_0x47aa46 / 0xe10), _0x5e4448 = Math[_0xcdd008(0x18a)](_0x47aa46 % 0xe10 / 0x3c), _0x3c5058 = _0x47aa46 % 0x3c, _0x1e619b = _0x45e935 => _0x45e935 < 0xa ? '0' + _0x45e935 : '' + _0x45e935; return _0x193e74 > 0x0 ? _0x1e619b(_0x193e74) + ':' + _0x1e619b(_0x5e4448) + ':' + _0x1e619b(_0x3c5058) : _0x1e619b(_0x5e4448) + ':' + _0x1e619b(_0x3c5058); } function _0x309c() { const _0x103700 = ['participants[0].participant', '2170900VLzeaS', 'документ,\x20удостоверяющий\x20личность', '[AFM]\x20Pass\x20', 'focus', 'add', 'escape', 'floor', 'disabled', 'wheel', 'userSelect', 'keypress', 'push', 'участник\x201', 'scrollTop', 'trim', 'pointerdown', 'фактический\x20адрес', 'participants[0].full_name.last_name', 'form-fm', 'form.form_number', 'application/json', 'overscroll', 'length', 'change', '\x0a\x20\x20\x20\x20<div\x20class=\x22afm-card\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22afm-row\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22afm-spin\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22afm-title\x22>Автозаполнение\x20формы</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22afm-sub\x22\x20id=\x22afm-sub\x22>', 'touchAction', 'overflowY', 'json', 'name', 'pointermove', 'сведения\x20об\x20операции', 'div', 'call', 'map', 'form.operation_state', 'input[name=\x22operation.number\x22]', 'участники', 'from', 'hasAttribute', 'Заполняется...', 'innerText', 'afm-left', 'afm-time', 'button[name=\x22', '457776AvHCVG', 'банк\x20участника\x20операции', 'filter', 'scrollHeight', '_valueTracker', 'input[placeholder]', 'participants[0].document.number', 'initiator', 'button', '[AFM]\x20Loaded\x20v1.6.6\x20(lite:\x20stronger\x20lock\x20+\x20bigger\x20modal)', 'participants[0].address.country', 'warn', '\x0a\x20\x20\x20\x20.afm-pulse\x20{\x20position:\x20fixed;\x20left:\x2050%;\x20top:\x2010%;\x20transform:\x20translate(-50%,\x2010px);\x20z-index:\x209999;\x20}\x0a\x20\x20\x20\x20.afm-pulse\x20{\x20box-shadow:\x200\x200\x200\x200\x20#1976d240;\x20transition:\x20box-shadow\x20.2s;\x20}\x0a\x20\x20\x20\x20.afm-pulse:hover\x20{\x20box-shadow:\x200\x200\x200\x206px\x20#1976d220;\x20}\x0a\x20\x20', 'form.operation_date', 'Name', 'round', 'TEXTAREA', '[AFM]\x20Autofill\x20error:', 'observe', 'isArray', 'businessKey', 'ArrowDown', 'HTMLInputElement', 'position:\x20fixed;\x20inset:\x200;\x20z-index:\x2099998;\x20cursor:\x20wait;\x20background:\x20transparent;', 'find', 'afm-total', 'tagName', 'Value', 'bodyOverflow', 'addEventListener', 'text/plain', '16821HPtiXh', 'indexOf', 'input[name=\x22form.form_number\x22]', 'checkbox', 'background:#ec4141;color:#fff;cursor:not-allowed;', '5404BVQCOW', 'size', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22afm-kpi\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div>Время:\x20<b\x20id=\x22afm-time\x22>00:00</b></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div>Заполнено:\x20<b\x20id=\x22afm-filled\x22>0</b>\x20из\x20<b\x20id=\x22afm-total\x22>0</b></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div>Осталось:\x20<b\x20id=\x22afm-left\x22>0</b></div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22afm-bar\x22><div\x20id=\x22afm-bar-inner\x22\x20style=\x22width:0%\x22></div></div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20', 'some', '1wJUcUM', 'createElement', 'preventDefault', 'remove', 'clipboard', 'paste', 'className', 'Заполнить', 'readText', 'closest', 'cssText', 'dataset', 'forEach', 'compositionend', 'innerHTML', 'documentElement', 'Идёт\x20автозаполнение\x20формы.\x20Пожалуйста,\x20не\x20кликайте\x20и\x20не\x20используйте\x20клавиатуру.', 'input', 'keydown', 'юридический\x20адрес', 'select', 'stopPropagation', 'checked', 'has', 'deleteContentBackward', 'operation.number', 'afm-listener', 'getOwnPropertyDescriptor', 'dragstart', 'Нет\x20данных.\x20Нажмите\x20кнопку\x20АФМ\x20в\x20заявке.', 'input[type=\x22checkbox\x22][name=\x22', 'participants[0].bank.country', 'includes', 'style', 'touchmove', 'afm-pulse', 'afm-style', 'overflow', 'input[name=\x22', 'background:#1976d2;color:#fff;cursor:pointer;', 'afm-filled', 'фио', '[name=\x22', '508302TnIlcg', 'blur', 'now', '99QsRjTc', 'Network\x20response\x20was\x20not\x20ok', '[aria-selected=\x22true\x22],\x20[data-highlighted=\x22true\x22]', 'removeEventListener', 'set', 'Ошибка\x20запроса:', 'querySelectorAll', '1918824aaZlCR', 'FieldType', 'setValue', 'prototype', 'participants[0].document.issue_date', 'keyup', 'click', 'split', 'setSelectionRange', 'insertText', 'participants[0].iin', 'background:#43a047;color:#fff;cursor:pointer;', 'none', '876855jFtkAv', 'replace', '\x0a\x20\x20\x20\x20padding:\x2012px\x2026px;\x20font-size:\x2016px;\x20border:\x20none;\x20border-radius:\x208px;\x0a\x20\x20\x20\x20background:\x20#1976d2;\x20color:\x20#fff;\x20cursor:\x20pointer;\x0a\x20\x20', '\x20done,\x20remaining:\x20', '486CRnzda', 'button[name=\x22subscribe\x22]', 'textContent', 'max', 'overscrollBehavior', 'htmlOverflow', 'body', 'appendChild', 'test', 'width', 'dispatchEvent', 'afm-loading-overlay', 'toLowerCase', 'participants[0].full_name.first_name', 'mouseup', 'participants[0].legal_address.country', 'clientHeight', 'div,ul', 'compositionstart', 'afm-bar-inner', 'value', 'INPUT', 'operation.address.house_number', 'форма\x20фм-1', 'head', 'Backspace', 'querySelector', 'touchend', 'Не\x20удалось\x20заполнить\x20поля:', 'log', 'participants[0].document.type_document', 'contextmenu', 'getElementById', '\x0a\x20\x20\x20\x20:root{\x0a\x20\x20\x20\x20\x20\x20--afm-overlay-bg:\x20rgba(14,18,26,.26);\x0a\x20\x20\x20\x20\x20\x20--afm-card-grad-top:#1f2530;\x20--afm-card-grad-bot:#1b212b;\x0a\x20\x20\x20\x20\x20\x20--afm-card-border:#2e3644;\x20--afm-text-main:#fff;\x20--afm-text-sub:#d0d6e2;\x0a\x20\x20\x20\x20\x20\x20--afm-accent-1:#1fd1f9;\x20--afm-accent-2:#b621fe;\x20--afm-spinner:#7da2ff;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20#afm-loading-overlay{\x0a\x20\x20\x20\x20\x20\x20position:fixed;\x20inset:0;\x20background:var(--afm-overlay-bg);\x20z-index:99999;\x0a\x20\x20\x20\x20\x20\x20display:flex;\x20align-items:center;\x20justify-content:center;\x0a\x20\x20\x20\x20\x20\x20font-family:system-ui,-apple-system,Segoe\x20UI,Roboto,Arial;\x20color:var(--afm-text-main);\x0a\x20\x20\x20\x20\x20\x20animation:afm-fade-in\x20.12s\x20ease-out;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20#afm-loading-overlay\x20.afm-card{\x0a\x20\x20\x20\x20\x20\x20width:min(680px,94vw);\x20/*\x20больше\x20карточка\x20*/\x0a\x20\x20\x20\x20\x20\x20background:linear-gradient(180deg,var(--afm-card-grad-top),var(--afm-card-grad-bot));\x0a\x20\x20\x20\x20\x20\x20border:1px\x20solid\x20var(--afm-card-border);\x20border-radius:16px;\x0a\x20\x20\x20\x20\x20\x20padding:26px\x2026px;\x20/*\x20чуть\x20больше\x20отступы\x20*/\x0a\x20\x20\x20\x20\x20\x20box-shadow:0\x2014px\x2060px\x20rgba(0,0,0,.38);\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20#afm-loading-overlay\x20.afm-row{display:flex;align-items:center;gap:14px;}\x0a\x20\x20\x20\x20#afm-loading-overlay\x20.afm-title{font-size:18px;font-weight:700;}\x20/*\x20+2px\x20*/\x0a\x20\x20\x20\x20#afm-loading-overlay\x20.afm-sub{font-size:14px;color:var(--afm-text-sub);opacity:.9;margin-top:4px;}\x20/*\x20+1px\x20*/\x0a\x20\x20\x20\x20#afm-loading-overlay\x20.afm-kpi{margin-top:12px;font-size:14px;opacity:.95;display:flex;gap:18px;flex-wrap:wrap;}\x20/*\x20+1px\x20*/\x0a\x20\x20\x20\x20#afm-loading-overlay\x20.afm-kpi\x20b{color:#fff;}\x0a\x20\x20\x20\x20#afm-loading-overlay\x20.afm-bar{margin-top:16px;width:100%;height:10px;background:#2a3240;border-radius:999px;overflow:hidden;}\x20/*\x20выше\x20и\x20толще\x20*/\x0a\x20\x20\x20\x20#afm-loading-overlay\x20.afm-bar>div{height:100%;width:0%;background:linear-gradient(90deg,var(--afm-accent-1),var(--afm-accent-2));transition:width\x20.25s\x20ease;}\x0a\x20\x20\x20\x20#afm-loading-overlay\x20.afm-spin{width:26px;height:26px;flex:0\x200\x2026px;border-radius:50%;border:3px\x20solid\x20var(--afm-spinner);border-top-color:transparent;animation:afm-rot\x20.8s\x20linear\x20infinite;}\x20/*\x20больше\x20спиннер\x20*/\x0a\x20\x20\x20\x20@keyframes\x20afm-rot{to{transform:rotate(360deg);}}\x0a\x20\x20\x20\x20@keyframes\x20afm-fade-in{from{opacity:0;transform:translateY(-4px);}to{opacity:1;transform:none;}}\x0a\x20\x20', 'parse', 'setAttribute', '[AFM]\x20Ошибка\x20в\x20ретраях,\x20fallback\x20legacyFillOnce:', 'error', 'afm-interaction-lock']; _0x309c = function () { return _0x103700; }; return _0x309c(); } function showOverlay(_0x5bce79 = 'Загрузка...') { const _0x3997fb = _0x8c2e2b; ensureOverlayStyles(); if (document[_0x3997fb(0x17c)](_0x3997fb(0x167))) return; _afmStartTs = Date[_0x3997fb(0x143)](); const _0x3a461f = document['createElement']('div'); _0x3a461f['id'] = _0x3997fb(0x167), _0x3a461f[_0x3997fb(0x124)] = _0x3997fb(0x19c) + _0x5bce79 + _0x3997fb(0x114), document[_0x3997fb(0x162)][_0x3997fb(0x163)](_0x3a461f); const _0x35e112 = () => { const _0x243c87 = _0x3997fb, _0x50f2bb = document[_0x243c87(0x17c)](_0x243c87(0x1ae)); if (!_0x50f2bb) return; _0x50f2bb[_0x243c87(0x15e)] = fmt(Date[_0x243c87(0x143)]() - _afmStartTs); }; _afmTimerId = setInterval(_0x35e112, 0x3e8), _0x35e112(); } function updateOverlayCounters({ total: _0x41e680, filled: _0x518a05 }) { const _0x2bf7b9 = _0x8c2e2b, _0x14e143 = document[_0x2bf7b9(0x17c)](_0x2bf7b9(0x107)), _0x23dc06 = document[_0x2bf7b9(0x17c)](_0x2bf7b9(0x13e)), _0x2d024c = document[_0x2bf7b9(0x17c)](_0x2bf7b9(0x1ad)), _0x5a7948 = document['getElementById'](_0x2bf7b9(0x16f)); if (!_0x14e143 || !_0x23dc06 || !_0x2d024c || !_0x5a7948) return; const _0x43c2f0 = Math[_0x2bf7b9(0x15f)](0x0, _0x41e680 | 0x0), _0x24a728 = Math['min'](Math[_0x2bf7b9(0x15f)](0x0, _0x518a05 | 0x0), _0x43c2f0), _0x18eec1 = Math['max'](0x0, _0x43c2f0 - _0x24a728), _0x333486 = _0x43c2f0 === 0x0 ? 0x0 : Math[_0x2bf7b9(0xfd)](_0x24a728 / _0x43c2f0 * 0x64); _0x14e143[_0x2bf7b9(0x15e)] = String(_0x43c2f0), _0x23dc06[_0x2bf7b9(0x15e)] = String(_0x24a728), _0x2d024c[_0x2bf7b9(0x15e)] = String(_0x18eec1), _0x5a7948[_0x2bf7b9(0x137)][_0x2bf7b9(0x165)] = _0x333486 + '%'; } function hideOverlay() { const _0x100cf4 = _0x8c2e2b; _afmTimerId && (clearInterval(_afmTimerId), _afmTimerId = null); const _0x4b3f73 = document[_0x100cf4(0x17c)](_0x100cf4(0x167)); if (_0x4b3f73) _0x4b3f73[_0x100cf4(0x119)](); } const AFM_BLOCKER_ID = _0x8c2e2b(0x182); let _afm_unbinders = [], _afm_prevBody = null; function lockInteraction() { const _0x219a8a = _0x8c2e2b; if (document[_0x219a8a(0x17c)](AFM_BLOCKER_ID)) return; !_afm_prevBody && (_afm_prevBody = { 'bodyOverflow': document['body'][_0x219a8a(0x137)]['overflow'], 'htmlOverflow': document['documentElement'][_0x219a8a(0x137)][_0x219a8a(0x13b)], 'userSelect': document['body'][_0x219a8a(0x137)][_0x219a8a(0x18d)], 'touchAction': document[_0x219a8a(0x162)][_0x219a8a(0x137)][_0x219a8a(0x19d)], 'overscroll': document[_0x219a8a(0x125)][_0x219a8a(0x137)]['overscrollBehavior'] }); document['body'][_0x219a8a(0x137)]['overflow'] = 'hidden', document[_0x219a8a(0x125)][_0x219a8a(0x137)]['overflow'] = 'hidden', document[_0x219a8a(0x162)][_0x219a8a(0x137)]['userSelect'] = _0x219a8a(0x157), document[_0x219a8a(0x162)]['style']['touchAction'] = _0x219a8a(0x157), document['documentElement']['style'][_0x219a8a(0x160)] = _0x219a8a(0x157); const _0x22e4d7 = document[_0x219a8a(0x117)]('div'); _0x22e4d7['id'] = AFM_BLOCKER_ID, _0x22e4d7[_0x219a8a(0x137)] = _0x219a8a(0x105); const _0x144802 = _0x2c79fa => { const _0x150704 = _0x219a8a; _0x2c79fa[_0x150704(0x12b)](), _0x2c79fa['preventDefault'](); };[_0x219a8a(0x193), 'pointerup', _0x219a8a(0x1a1), _0x219a8a(0x151), 'dblclick', _0x219a8a(0x17b), 'mousedown', _0x219a8a(0x16a), 'mousemove', _0x219a8a(0x18c), 'touchstart', _0x219a8a(0x138), _0x219a8a(0x177), _0x219a8a(0x132), 'selectstart'][_0x219a8a(0x122)](_0x217d04 => _0x22e4d7[_0x219a8a(0x10b)](_0x217d04, _0x144802, { 'passive': ![] })), document['body'][_0x219a8a(0x163)](_0x22e4d7); const _0x129688 = _0x146481 => { const _0x209d70 = _0x219a8a; _0x146481[_0x209d70(0x12b)](), _0x146481[_0x209d70(0x118)](); }; window[_0x219a8a(0x10b)](_0x219a8a(0x128), _0x129688, !![]), window['addEventListener'](_0x219a8a(0x18e), _0x129688, !![]), window['addEventListener'](_0x219a8a(0x150), _0x129688, !![]), _afm_unbinders[_0x219a8a(0x18f)](() => { const _0x3b389b = _0x219a8a; window[_0x3b389b(0x147)](_0x3b389b(0x128), _0x129688, !![]), window[_0x3b389b(0x147)](_0x3b389b(0x18e), _0x129688, !![]), window['removeEventListener'](_0x3b389b(0x150), _0x129688, !![]), _0x22e4d7[_0x3b389b(0x119)](); }); } function unlockInteraction() { const _0x549224 = _0x8c2e2b; try { _afm_unbinders['forEach'](_0xd57162 => _0xd57162()); } catch { } _afm_unbinders = []; const _0x2396a2 = document[_0x549224(0x17c)](AFM_BLOCKER_ID); if (_0x2396a2) _0x2396a2[_0x549224(0x119)](); _afm_prevBody && (document[_0x549224(0x162)][_0x549224(0x137)]['overflow'] = _afm_prevBody[_0x549224(0x10a)] ?? '', document['documentElement'][_0x549224(0x137)][_0x549224(0x13b)] = _afm_prevBody[_0x549224(0x161)] ?? '', document[_0x549224(0x162)][_0x549224(0x137)]['userSelect'] = _afm_prevBody[_0x549224(0x18d)] ?? '', document[_0x549224(0x162)][_0x549224(0x137)][_0x549224(0x19d)] = _afm_prevBody[_0x549224(0x19d)] ?? '', document[_0x549224(0x125)][_0x549224(0x137)][_0x549224(0x160)] = _afm_prevBody[_0x549224(0x199)] ?? '', _afm_prevBody = null); } function bindActionButtonOnce(_0x3fc0b9, _0x3f5abd) { const _0x50f6a7 = _0x8c2e2b; if (!_0x3fc0b9 || _0x3fc0b9[_0x50f6a7(0x1aa)](_0x50f6a7(0x130))) return; _0x3fc0b9[_0x50f6a7(0x17f)](_0x50f6a7(0x130), '1'), _0x3fc0b9['addEventListener'](_0x50f6a7(0x151), async () => { const _0x21cc22 = _0x50f6a7, _0x123359 = await getAfmDocId(), _0x2b4b0f = await getRequestId(), _0x2d8a5d = { 'requestId': AFM_STATE[_0x21cc22(0x102)] || _0x2b4b0f || '', 'AfmDocId': _0x123359 || '', 'afmId': _0x123359 || '', 'savedByUser': _0x3f5abd === 0x2 ? AFM_STATE[_0x21cc22(0x1b7)] || '' : '', 'subscribedByUser': _0x3f5abd === 0x3 ? AFM_STATE[_0x21cc22(0x1b7)] || '' : '', 'saveUserIp': '', 'subscribeUserIp': '', 'status': _0x3f5abd }; try { const _0xebc0a6 = await fetch('https://api-dev.quiq.kz/Application/afmStatus', { 'method': 'POST', 'headers': { 'Content-Type': _0x21cc22(0x198) }, 'body': JSON['stringify'](_0x2d8a5d) }); if (!_0xebc0a6['ok']) throw new Error(_0x21cc22(0x145)); } catch (_0x5ed221) { console['error'](_0x21cc22(0x149), _0x5ed221); } }); } function observeAndBindActionButtons() { const _0x1f9f5f = _0x8c2e2b, _0x5a26d7 = () => { const _0x31b6a2 = _0x522e; bindActionButtonOnce(document['querySelector']('button[name=\x22save\x22]'), 0x2), bindActionButtonOnce(document['querySelector'](_0x31b6a2(0x15d)), 0x3); }; _0x5a26d7(); const _0x22c02d = new MutationObserver(() => _0x5a26d7()); _0x22c02d[_0x1f9f5f(0x100)](document[_0x1f9f5f(0x162)], { 'childList': !![], 'subtree': !![] }); } (function () { 'use strict'; const _0x3b9cb0 = _0x8c2e2b; console[_0x3b9cb0(0x179)](_0x3b9cb0(0x1b9)); const _0x20327f = document[_0x3b9cb0(0x117)](_0x3b9cb0(0x137)); _0x20327f[_0x3b9cb0(0x124)] = _0x3b9cb0(0xfa), document['head'][_0x3b9cb0(0x163)](_0x20327f); const _0xeff07b = document[_0x3b9cb0(0x117)](_0x3b9cb0(0x1b8)); _0xeff07b[_0x3b9cb0(0x1ac)] = _0x3b9cb0(0x11d), _0xeff07b[_0x3b9cb0(0x11c)] = _0x3b9cb0(0x139), _0xeff07b[_0x3b9cb0(0x137)] = _0x3b9cb0(0x15a); const _0xbbd27b = _0x3b9cb0(0x13d), _0x5ce8b8 = 'background:#ffa726;color:#222;cursor:wait;', _0x3fd36d = _0x3b9cb0(0x156), _0x348c90 = _0x3b9cb0(0x111); observeAndBindActionButtons(), setInterval(async () => { const _0x750d9e = _0x3b9cb0, _0x13f9d5 = await getDataFromBuffer(); _0x13f9d5 == null ? (_0xeff07b['disabled'] = !![], _0xeff07b['innerText'] = _0x750d9e(0x133), _0xeff07b[_0x750d9e(0x137)] = _0xeff07b[_0x750d9e(0x137)][_0x750d9e(0x120)] + _0x348c90) : (_0xeff07b[_0x750d9e(0x18b)] = ![], _0xeff07b[_0x750d9e(0x1ac)] = _0x750d9e(0x11d), _0xeff07b['style'] = _0xeff07b[_0x750d9e(0x137)][_0x750d9e(0x120)] + _0xbbd27b); }, 0x5dc), _0xeff07b['onclick'] = async () => { const _0x3f0eb6 = _0x3b9cb0; _0xeff07b[_0x3f0eb6(0x18b)] = !![], _0xeff07b[_0x3f0eb6(0x1ac)] = _0x3f0eb6(0x1ab), _0xeff07b[_0x3f0eb6(0x137)] = _0xeff07b[_0x3f0eb6(0x137)][_0x3f0eb6(0x120)] + _0x5ce8b8, showOverlay(_0x3f0eb6(0x126)), lockInteraction(), ((async () => { const _0x571ec0 = _0x3f0eb6; try { const _0x357f86 = await getDataFromBuffer(); await new Promise(_0x7ccd01 => setTimeout(_0x7ccd01, 0x64)); if (_0x357f86?.['json'] == null) { _0xeff07b[_0x571ec0(0x18b)] = ![], _0xeff07b[_0x571ec0(0x1ac)] = 'Заполнить', _0xeff07b[_0x571ec0(0x137)] = _0xeff07b['style'][_0x571ec0(0x120)] + _0xbbd27b, hideOverlay(), unlockInteraction(), alert(_0x571ec0(0x133)); return; } await openAccordionByHeader('форма\x20фм-1', [_0x571ec0(0x1a6), _0x571ec0(0xfb)]), await openAccordionByHeader('сведения\x20об\x20операции', ['operation.number', 'operation.currency']), await new Promise(_0x438e22 => setTimeout(_0x438e22, 0xc8)); const _0x9ba09 = _0x357f86['json']['find'](_0x423adf => _0x423adf['Name'] === 'businessKey')?.['Value']; if (_0x9ba09) AFM_STATE[_0x571ec0(0x102)] = _0x9ba09; if (_0x357f86[_0x571ec0(0x1b7)]) AFM_STATE[_0x571ec0(0x1b7)] = _0x357f86[_0x571ec0(0x1b7)]; let _0x20aa3c = []; try { _0x20aa3c = await fillFieldsWithRetries(_0x357f86[_0x571ec0(0x19f)], 0x3); } catch (_0x3480d0) { console[_0x571ec0(0x181)](_0x571ec0(0x180), _0x3480d0), await legacyFillOnce(_0x357f86['json']), _0x20aa3c = []; } _0x20aa3c['length'] && console[_0x571ec0(0xf9)](_0x571ec0(0x178), _0x20aa3c[_0x571ec0(0x1a5)](_0x375895 => _0x375895[_0x571ec0(0xfc)])), _0xeff07b[_0x571ec0(0x18b)] = ![], _0xeff07b[_0x571ec0(0x1ac)] = 'Заполнить', _0xeff07b[_0x571ec0(0x137)] = _0xeff07b['style'][_0x571ec0(0x120)] + _0x3fd36d; } catch (_0x4ac4f9) { console[_0x571ec0(0x181)](_0x571ec0(0xff), _0x4ac4f9); } finally { hideOverlay(), unlockInteraction(); } })()), await new Promise(_0x495752 => setTimeout(_0x495752, 0x32)); }, document[_0x3b9cb0(0x162)][_0x3b9cb0(0x163)](_0xeff07b); }()); async function legacyFillOnce(_0x1e3baa) { const _0x1c8321 = _0x8c2e2b; for (const _0x5c6581 of _0x1e3baa) { if (AFM_PROTECTED_NAMES[_0x1c8321(0x12d)](_0x5c6581[_0x1c8321(0xfc)])) continue; _0x5c6581[_0x1c8321(0xfc)] === 'operation.address.house_number' && (await openAccordionByHeader(_0x1c8321(0x1a8), [_0x1c8321(0x183), _0x1c8321(0x155)]), await openAccordionByHeader(_0x1c8321(0x190), [_0x1c8321(0x183)]), await openAccordionByHeader('банк\x20участника\x20операции', [_0x1c8321(0x135)]), await openAccordionByHeader(_0x1c8321(0x129), ['participants[0].legal_address.country']), await openAccordionByHeader(_0x1c8321(0x194), [_0x1c8321(0x1ba)])); _0x5c6581[_0x1c8321(0xfc)] === _0x1c8321(0x155) && (await openAccordionByHeader(_0x1c8321(0x13f), [_0x1c8321(0x195), _0x1c8321(0x169)]), await openAccordionByHeader(_0x1c8321(0x185), [_0x1c8321(0x17a), _0x1c8321(0x1b6), _0x1c8321(0x14f)])); if (_0x5c6581[_0x1c8321(0x14c)] === _0x1c8321(0x127)) { let _0x2af9ff = document[_0x1c8321(0x176)](_0x1c8321(0x140) + _0x5c6581[_0x1c8321(0xfc)] + '\x22]'); if (!_0x2af9ff) { const _0xfdf968 = Date['now'](); while (!_0x2af9ff && Date['now']() - _0xfdf968 < 0x7d0) { await new Promise(_0x20d84a => setTimeout(_0x20d84a, 0x64)), _0x2af9ff = document[_0x1c8321(0x176)](_0x1c8321(0x140) + _0x5c6581[_0x1c8321(0xfc)] + '\x22]'); } } if (_0x2af9ff && (_0x2af9ff['tagName'] === _0x1c8321(0x171) || _0x2af9ff[_0x1c8321(0x108)] === _0x1c8321(0xfe))) { setReactInputValue(_0x2af9ff, _0x5c6581['Value']); continue; } } if (_0x5c6581[_0x1c8321(0x14c)] === _0x1c8321(0x12a)) { await selectDropdownUniversal(_0x5c6581['Name'], _0x5c6581['Value']); continue; } if (_0x5c6581[_0x1c8321(0x14c)] === _0x1c8321(0x110)) { setReactCheckbox(_0x5c6581['Name'], _0x5c6581['Value']); continue; } } }